SELECT AFITITU
SET ORDER TO AFITITU3
STORE 05 TO LIBRCAR
STORE 00 TO CIBRCAR
on key label f4 do winbus
DEFI WIND BRCAR FROM LIBRCAR,CIBRCAR TO LIBRCAR+19,CIBRCAR+79;
                TITLE " BUSQUEDA DE AFILIADOS ";
                FOOTER " F4=Buscar Organizacion-Cliente, ESC=Seleccionar ";
                DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND BRCAR
BROWSE FIELDS ORGA:H="ORGANIZ.-CLIENTE", NIVORG1:H="NIVEL 1",NIVORG2:H="NIVEL 2", NIVORG3:H="NIVEL 3",;
              CEDTITU:H="C.I.TITULAR", PAPELLIDO:H="PRIMER APELLIDO", PNOMBRE:H="PRIMER NOMBRE", SNOMBRE:H="SEGUNDO NOMBRE";
              NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW BRCAR
RELEASE WIND BRCAR
SELECT AFITITU
SET ORDER TO AFITITU1
STORE AFIAFI.CEDTITU+AFIAFI.CARGA TO WCODPAC
STORE AFIAFI.CEDTITU    TO WCEDTITU
STORE AFIAFI.CARGA      TO WCARGA
STORE AFITITU.ESTADO    TO WESTADO
STORE AFITITU.CIUDAD    TO WCIUDAD
STORE AFITITU.MUNICIPIO TO WMUNICIPIO
STORE AFITITU.ORGA      TO WORGA
STORE AFITITU.NIVORG1   TO WNIVORG1
STORE AFITITU.NIVORG2   TO WNIVORG2
STORE AFITITU.NIVORG3   TO WNIVORG3
STORE AFITITU.CONTRATO  TO WCONTRATO
STORE AFITITU.PLAN      TO WPLAN
RETURN
procedure winbus
DEFI WIND winbus FROM LIBRCAR+3,CIBRCAR TO LIBRCAR+6,CIBRCAR+79;
                TITLE " BUSQUEDA DE AFILIADOS POR ORGANIZACION-CLIENTE ";
                DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
acti wind winbus
@ 00,00 clear
store space(4) to m.orga
store space(2) to m.nivorg1
store space(2) to m.nivorg2
store space(2) to m.nivorg3
@ 00,00 SAY "ORG."
@ 00,05 SAY "N1"
@ 00,08 SAY "N2"
@ 00,11 SAY "N3"
@ 01,00 get m.orga
@ 01,05 get m.nivorg1
@ 01,08 get m.nivorg2
@ 01,11 get m.nivorg3
read
if lastkey()=27
   rele wind winbus
   return
endif
select afititu
set order to afititu3
store m.orga+m.nivorg1+m.nivorg2+m.nivorg3 to worga
seek ALLTRIM(worga)
if .not. found()
   store "NO EXISTE, VERIFIQUE" to wtext
   do aviso with wtext
endif
rele wind winbus
return

