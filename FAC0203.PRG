PUSH KEY CLEAR
DEFI WIND WINDGE FROM 1,0 TO 19,79;
          TITLE  " CUENTAS POR COBRAR " ;
          FOOTER " F1=Inc, F2=Abo, F3=Anu, F4=Bus, F5=Ord, F6=Ver, Esc=Salir " ;
          DOUBLE NOFLOAT NOZOOM NOGROW COLOR SCHEME 10
DEFI WIND WINDTT FROM 20,0 TO 22,79;
          DOUBLE NOFLOAT NOZOOM NOGROW COLOR SCHEME 10
ON KEY LABEL F1 DO PROGEINC
ON KEY LABEL F2 DO PROGEABO
ON KEY LABEL F3 DO PROGEELI
ON KEY LABEL F4 DO PROGEBUS
ON KEY LABEL F5 DO PROGEORD
ON KEY LABEL F6 DO PROGEVER
ACTI WIND WINDGE
SELECT FACCXC
SET ORDER TO FACCXC1
GO BOTT
BROWSE FIELDS WCODCXC=FUNCOD():H="Codigo",;
              ELABORADO:H="Elaborada",;
              WFACAREA=FUNAREA():H="Area",;
              TOTDOC:H="Monto",;
              WSTATCXC=FUNSTATCXC():H="Canc.",;
              WNOMCLI=FUNNOMCLI():H="Cliente                       ",;
              REFERENCIA:H="Referencia";
       NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW WINDGE 
DEACT WIND WINDGE
DEACT WIND WINDTT
POP KEY
RETURN
***********
FUNC FUNCOD
***********
STORE SUBSTR(FACCXC.CODCXC,1,7) TO WCODCXC
RETURN WCODCXC
************
FUNC FUNAREA
************
SELECT FACDCGE
SEEK FACCXC.REFERENCIA
IF FOUND()
   STORE AREA     TO WFACAREA
ELSE
   STORE SPACE(3) TO WFACAREA
ENDIF
SELECT FACCXC
RETURN WFACAREA
***************
FUNC FUNSTATCXC
***************
IF FACCXC.CANCELADO<>CTOD("  -  -    ")
   STORE "Si" TO WSTATCXC
ELSE
   STORE "  " TO WSTATCXC
ENDIF
RETURN WSTATCXC
**************
FUNC FUNNOMCLI
**************
SELECT FACCLI
SEEK FACCXC.CODCLI
IF .NOT. FOUND()
   STORE ""     TO WNOMCLI    
ELSE
   STORE DESCLI TO WNOMCLI
ENDIF
SELECT FACCXC
RETURN WNOMCLI
******************
PROCEDURE PROGEORD
******************
DEFI WIND WINDBUS FROM 12,10 TO 14,70;
          TITLE " ORDEN ";
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTIVATE WIND WINDBUS
DO WHILE .T.
   STORE 1 TO WOP
   @ 00,03 SAY "OPCIONES: ";
   GET WOP PICT "@*H No.CUENTA;CLIENTE  ;FACTURA"
   READ
   IF LASTKEY()=13
      EXIT
   ENDIF
ENDDO
RELE WIND WINDBUS
DEAC WIND WINDGE 
SELECT FACCXC 
IF WOP=1
   SET ORDER TO FACCXC1
ENDIF
IF WOP=2
   SET ORDER TO FACCXC2
ENDIF
IF WOP=3
   SET ORDER TO FACCXC3
ENDIF
ACTI WIND WINDGE  
RETURN
******************
PROCEDURE PROGEINC
******************
PUSH KEY CLEAR
SELECT FACCXC
SET ORDER TO FACCXC1
DO FAC0203I
POP KEY
SELECT FACCXC 
RETURN
******************
PROCEDURE PROGEABO
******************
PUSH KEY CLEAR
SELECT FACCXC
SET ORDER TO FACCXC1
DO FAC0203A
POP KEY
SELECT FACCXC  
RETURN
******************
PROCEDURE PROGEELI
******************
PUSH KEY CLEAR
SELECT FACCXC
SET ORDER TO FACCXC1
DO FAC0203E
SELECT FACCXC  
POP KEY
RETURN
******************
PROCEDURE PROGEBUS
******************
PUSH KEY CLEAR
DEFI WIND WINDBUS FROM 12,12 TO 14,55;
          TITLE " BUSCAR ";
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTIVATE WIND WINDBUS
STORE SPACE(14) TO WCAMPO
@ 00,03 SAY "CLAVE: " GET WCAMPO
READ
SEEK RTRIM(WCAMPO)
RELE WIND WINDBUS
POP KEY
RETURN
******************
PROCEDURE PROGEVER
******************
PUSH KEY CLEAR
DEFI WIND WINDVER FROM 12,19 TO 14,59;
          TITLE " SALIDA ";
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTIVATE WIND WINDVER
DO WHILE .T.
   STORE 1 TO WOP
   @ 00,03 SAY "OPCIONES: ";
   GET WOP PICT "@*H IMPRESORA;MONITOR   "
   READ
   IF LASTKEY()=13
      EXIT
   ENDIF
ENDDO
RELE WIND WINDVER
STORE FACCXC.CODCXC  TO WCODCXC
STORE WOP            TO WSALIDA
DO FACIMPCC
POP KEY
SELECT FACDCGE
RETURN
******************************* RUTINAS ***********************************
************
PROC CONVNUM
************
STORE LTRIM(STR(M.NUMERON,7))                   TO M.NUMERON
STORE REPLICATE("0",7-LEN(M.NUMERON))+M.NUMERON TO M.NUMERON
RETURN



