DEFINE WIND ESTA FROM 5,00 to 12,50;
                 TITLE "< ESTADISTICA DE ACTIVIDADES POR MEDICO >";
                 DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND ESTA
STORE DATE()   TO WFI
STORE DATE()   TO WFT
STORE SPACE(3) TO WMED
@ 01,01 SAY "DESDE  :"
@ 03,01 SAY "HASTA  :"
@ 05,01 SAY "MEDICO :"
@ 01,10 GET WFI
@ 03,10 GET WFT
READ
IF WFI>WFT
   STORE "ERROR EN FECHAS, VERIFIQUE" TO WTEXT
   DO AVISO WITH WTEXT
   RETURN
ENDIF
@ 05,10 GET WMED
READ

SELECT HISGEN
SET RELA TO
STORE 0   TO WNUMPRI
STORE 0   TO WNUMCON
STORE 0   TO WNUMOTR
STORE 100 TO WLINEA
DO HEADER
SELECT SYSMED
GO TOP
DO WHILE.NOT.EOF()
   IF WMED<>SPACE(3).AND.WMED<>MEDICO
      SELECT SYSMED
      SKIP
      LOOP
   ENDIF
   STORE 0      TO WPRIDOC
   STORE 0      TO WCONDOC
   STORE 0      TO WOTRDOC
   SELECT HISGEN
   SET ORDER TO HISGEN2
   STORE SYSMED.MEDICO TO WCLAVE
   SEEK WCLAVE
   IF .NOT.FOUND()
      DO PRINDOC
      SELECT SYSMED
      SKIP
      LOOP
   ENDIF
   DO WHILE.NOT.EOF()
      IF CODDOC=SYSMED.MEDICO
         IF FECACT<WFI
            SELECT HISGEN
            SKIP
            LOOP
         ENDIF
         IF FECACT>WFT
            EXIT
         ENDIF
         IF CODACT="05"
            STORE WNUMPRI+1 TO WNUMPRI
            STORE WPRIDOC+1 TO WPRIDOC
         ELSE
            IF CODACT="10"
               STORE WNUMCON+1 TO WNUMCON
               STORE WCONDOC+1 TO WCONDOC
            ELSE
               STORE WNUMOTR+1 TO WNUMOTR
               STORE WOTRDOC+1 TO WOTRDOC
            ENDIF
         ENDIF
      ENDIF
      SELECT HISGEN
      SKIP
   ENDDO
   DO PRINDOC
   SELECT SYSMED
   SKIP
ENDDO
STORE WLINEA+1 TO WLINEA
@ WLINEA,00 SAY REPLICATE("-",80)
STORE WLINEA+1 TO WLINEA
@ WLINEA,00 SAY "TOTALES GENERALES"
@ WLINEA,40 SAY WNUMPRI                  PICT "####"
@ WLINEA,50 SAY WNUMCON                  PICT "####"
@ WLINEA,60 SAY WNUMOTR                  PICT "####"
@ WLINEA,70 SAY WNUMPRI+WNUMCON+WNUMOTR  PICT "####"
SET DEVI TO SCRE
SELECT HISGEN
SET ORDER TO HISGEN1
DEAC WIND ESTA
RETURN
***************
PROC HEADER
***************
SET DEVI  TO PRINT
@ 00,00 SAY CHR(14)+QQWW
@ 02,00 SAY "ESTADISTICA DE CONSULTAS POR MEDICO"
@ 03,00 SAY "DESDE :"+DTOC(WFI)+"  HASTA :"+DTOC(WFT)
@ 04,00 SAY "MEDICO"
@ 04,40 SAY "PRIMERA"
@ 04,50 SAY "CONTROL"
@ 04,60 SAY "OTRAS  "
@ 04,70 SAY "TOTAL  "
@ 05,00 SAY REPLICATE("-",80)
STORE 6 TO WLINEA
************
PROC PRINDOC
************
STORE WLINEA+1 TO WLINEA
IF WLINEA>=55
   DO HEADER
ENDIF
@ WLINEA,00 SAY SYSMED.NOMBRE
@ WLINEA,40 SAY WPRIDOC                  PICT "####"
@ WLINEA,50 SAY WCONDOC                  PICT "####"
@ WLINEA,60 SAY WOTRDOC                  PICT "####"
@ WLINEA,70 SAY WPRIDOC+WCONDOC+WOTRDOC  PICT "####"
RETURN



