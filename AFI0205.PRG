SELECT AFITITU
STORE 05 TO LIBRCAR
STORE 00 TO CIBRCAR
on key label f4 do winbus
DEFI WIND BRCAR FROM LIBRCAR,CIBRCAR TO LIBRCAR+19,CIBRCAR+79;
                TITLE " BUSQUEDA DE AFILIADOS ";
                FOOTER " F4=Buscar Localidad Geografica, ESC=Seleccionar ";
                DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND BRCAR
BROWSE FIELDS ESTADO:H="ESTADO", CIUDAD:H="CIUDAD 1",MUNICIPIO:H="MUNICIPIO",;
              CEDTITU:H="C.I.TITULAR", PAPELLIDO:H="PRIMER APELLIDO", PNOMBRE:H="PRIMER NOMBRE";
              NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW BRCAR
RELEASE WIND BRCAR
SELECT AFITITU
SET ORDER TO AFITITU1
STORE AFIAFI.CEDTITU+AFIAFI.CARGA TO WCODPAC
STORE AFIAFI.CEDTITU    TO WCEDTITU
STORE AFIAFI.CARGA      TO WCARGA
STORE AFITITU.ESTADO    TO WESTADO
STORE AFITITU.CIUDAD    TO WCIUDAD
STORE AFITITU.MUNICIPIO TO WMUNICIPIO
STORE AFITITU.ORGA      TO WORGA
STORE AFITITU.NIVORG1   TO WNIVORG1
STORE AFITITU.NIVORG2   TO WNIVORG2
STORE AFITITU.NIVORG3   TO WNIVORG3
STORE AFITITU.CONTRATO  TO WCONTRATO
STORE AFITITU.PLAN      TO WPLAN
RETURN

procedure winbus
DEFI WIND winbus FROM LIBRCAR+3,CIBRCAR TO LIBRCAR+6,CIBRCAR+79;
                TITLE " BUSQUEDA DE AFILIADOS POR LOCALIDAD GEOGRAFICA ";
                DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
acti wind winbus
@ 00,00 clear
store space(2) to m.estado
store space(2) to m.ciudad
store space(2) to m.municipio
@ 00,00 SAY "ESTADO"
@ 00,08 SAY "CIUDAD"
@ 00,16 SAY "MUNICIPIO"
@ 01,00 get m.estado
@ 01,08 get m.ciudad
@ 01,16 get m.municipio
read
if lastkey()=27
   rele wind winbus
   return
endif
select afititu
set order to afititu4
store m.estado+m.ciudad+m.municipio to wlocal
seek ALLTRIM(wlocal)
if .not. found()
   store "NO EXISTE, VERIFIQUE" to wtext
   do aviso with wtext
endif
rele wind winbus
return

