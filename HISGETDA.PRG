   DIME WHISDAT(WTOTLIN)
   STORE 1 TO WCONTLIN
   DO WHILE WCONTLIN<=WTOTLIN
      STORE SPACE(70) TO WHISDAT(WCONTLIN)
      STORE WCONTLIN+1 TO WCONTLIN
   ENDDO
   SELECT HISDET
   STORE WCODPAC+M.CODACT+STR(M.NUMACT,4)+M.CODREN TO WCLAVEDET
   SEEK WCLAVEDET
   STORE 0 TO WCONTLIN
   DO WHILE .NOT. EOF().AND.(WCODPAC+M.CODACT+STR(M.NUMACT,4)+CODREN)=WCLAVEDET
      STORE WCONTLIN+1 TO WCONTLIN
      STORE DATREN TO WHISDAT(WCONTLIN)
      SKIP
   ENDDO
   DEFINE WIND WINDAT FROM LIWINDAT,0 TO LIWINDAT+WTOTLIN+1,72;
                      TITLE " "+ALLTRIM(WTITLE)+" ";
                      FOOTER " ESC=Salir ";
                      DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
   ACTI WIND WINDAT
   STORE 1 TO WCONTLIN
   DO WHILE WCONTLIN<=WTOTLIN
      @ WCONTLIN-1,0 GET WHISDAT(WCONTLIN)
      STORE WCONTLIN+1 TO WCONTLIN
   ENDDO
   READ
   SELECT HISDET
   IF FILLOC()
      STORE WCODPAC+M.CODACT+STR(M.NUMACT,4)+M.CODREN TO WCLAVEDET
      DO WHILE .T.
         SEEK WCLAVEDET
         IF FOUND()
            DELETE
         ELSE
            EXIT
         ENDIF
      ENDDO
      STORE 1 TO WCONTLIN
      DO WHILE WCONTLIN<=WTOTLIN
         IF WHISDAT(WCONTLIN)<>SPACE(70)
            SELECT HISDET
            APPEND BLANK
            REPLACE CODPAC WITH WCODPAC
            REPLACE CODACT WITH M.CODACT
            REPLACE NUMACT WITH M.NUMACT
            REPLACE CODREN WITH M.CODREN
            REPLACE DATREN WITH WHISDAT(WCONTLIN)
         ENDIF
         STORE WCONTLIN+1 TO WCONTLIN
      ENDDO
      UNLOCK ALL
   ELSE
      STORE "OPERACION CANCELADA, REINTENTE" TO WTEXT
      DO AVISO WITH WTEXT
   ENDIF
   RELE WIND WINDAT
