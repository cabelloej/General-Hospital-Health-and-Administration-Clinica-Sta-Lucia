PUSH KEY CLEAR
DEFI WIND WINDCLI FROM 05,0 TO 20,79;
          TITLE " CLIENTES " ;
          FOOTER " F1=Inc, F2=Mod, F3=Eli, F4=Bus, Esc=Salir " ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDCLI
ON KEY LABEL F1 DO PROCLII
ON KEY LABEL F2 DO PROCLIM
ON KEY LABEL F3 DO PROCLIE
ON KEY LABEL F5 DO PROCLIB
SELECT FACCLI
BROWSE FIELDS CODCLI:H="CODIGO",DESCLI:H="NOMBRE",CODGRU:H="GRUPO",TELCLI1:H="TELEFONO",TELCLI2:H="TELEFONO";
       NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW WINDCLI
DEACT WIND WINDCLI
POP KEY
RETURN
************
PROC PROCLII
************
PUSH KEY CLEAR
STORE "INCLUIR" TO WFLAGR
SELECT FACCLI
SCATT MEMV BLANK
DO GETCLI
POP KEY
RETURN
************
PROC PROCLIM
************
PUSH KEY CLEAR
STORE "MODIFICAR" TO WFLAGR
SELECT FACCLI
SCATT MEMV
DO GETCLI
POP KEY
RETURN
************
PROC PROCLIE
************
PUSH KEY CLEAR
STORE "ELIMINAR" TO WFLAGR
STORE 2 TO WOP
DO PROCOPC WITH WFLAGR
IF WOP=1
   SELECT FACCLI
   IF RECLOC()
      DELETE
      UNLOCK
   ELSE
      DO PROCNUL
   ENDIF
ENDIF
POP KEY
RETURN
************
PROC PROCLIB
************
PUSH KEY CLEAR
POP KEY
RETURN
***********
PROC GETCLI
***********
DEFI WIND WINDGETC FROM 06,5 TO 15,79;
          TITLE  WFLAGR ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDGETC
IF WFLAGR="INCLUIR"
   @ 0,1 SAY "Codigo     :" GET M.CODCLI
   READ
   IF LASTKEY()=27.OR.M.CODCLI=SPACE(2)
      RELE WIND WINDGETC
      RETURN
   ENDIF
   SELECT FACCLI
   SEEK M.CODCLI
   IF FOUND()
      STORE "CODIGO YA EXISTE :"+ALLTRIM(DESCLI) TO WTEXT
      DO AVISO WITH WTEXT
      RELE WIND WINDGETC
      RETURN
   ENDIF
ELSE
   @ 0,1 SAY "Codigo     :" +   M.CODCLI
ENDIF
@ 1,1 SAY "Grupo      :" GET M.CODGRU  VALID VALGRU()
@ 2,1 SAY "Nombre     :" GET M.DESCLI
@ 3,1 SAY "Direccion  :" GET M.DIRCLI1
@ 4,1 SAY "           :" GET M.DIRCLI2
@ 5,1 SAY "Telefonos  :" GET M.TELCLI1
@ 6,1 SAY "           :" GET M.TELCLI2
READ
STORE 1 TO WOP
DO PROCOPC WITH WFLAGR
IF WOP=1
   SELECT FACCLI
   IF WFLAGR="INCLUIR"
      IF FILLOC()
         APPEND BLANK
         GATH MEMV
         UNLOCK ALL
      ELSE
        DO PROCNUL
      ENDIF
   ELSE
      IF RECLOC()
         GATH MEMV
         UNLOCK ALL
      ELSE
        DO PROCNUL
      ENDIF
   ENDIF
ENDIF
RELE WIND WINDGETC
RETURN
***********
FUNC VALGRU
***********
SELECT FACGRU
SEEK M.CODGRU
IF .NOT. FOUND()
    DO FAC0101
ENDIF
STORE FACGRU.CODGRU TO M.CODGRU
@ 1,20 SAY FACGRU.DESGRU
RETURN .T.
************
PROC PROCOPC
************
PARA WTITLE
DEFI WIND WINDCON FROM 12,19 TO 14,59;
          TITLE WTITLE;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTIVATE WIND WINDCON
DO WHILE .T.
   @ 00,03 SAY "OPCIONES: ";
   GET WOP PICT "@*H ACEPTAR  ;CANCELAR "
   READ
   IF LASTKEY()=13
      EXIT
   ENDIF
ENDDO
RELE WIND WINDCON
RETURN
************
PROC PROCNUL
************
STORE "OPERACION RECHAZADA, FAVOR REINTENTAR." TO WTEXT
DO AVISO WITH WTEXT
RETURN
