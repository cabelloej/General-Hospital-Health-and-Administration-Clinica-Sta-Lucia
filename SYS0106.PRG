SELECT SYSSERVI
DEFI WIND BRSER FROM LIBRSER,CIBRSER TO LIBRSER+16,CIBRSER+78 ;
                TITLE " SERVICIOS " ;
                FOOTER " F1=Inc,F2=Mod,F3=Eli,F4=Bus,F6=Lis,ESC=Sel ";
                DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND BRSER
ON KEY LABEL F1 DO BRINC
ON KEY LABEL F2 DO BRMOD
ON KEY LABEL F3 DO BRELI
ON KEY LABEL F4 DO BRBUS
ON KEY LABEL F6 DO SYS0106R
BROWSE FIELDS SERVICIO:H="TP-ES-GR-REN", WDESC=SERDESC():H="DESCRIPCION",PRECIOA:H="NIVEL A",PRECIOB:H="NIVEL B";
NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW BRSER
RELEASE WIND BRSER
RETURN
*********
FUNC SERDESC
*********
STORE SUBSTR(SYSSERVI.DESCRI,1,37) TO WDESC
RETURN WDESC
***********************
***                 ***
***RUTINAS DE BRSER ***
***                 ***
***********************
PROCEDURE BRINC
DEFI WIND WINCSER FROM LIBRSER+5,CIBRSER TO LIBRSER+14,CIBRSER+79;
                  TITLE " INCLUIR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINCSER
DO WHILE .T.
   SCAT MEMV BLANK
   @ 00,00 CLEAR
   @ 00,01 SAY "CODIGO:"
   @ 01,01 SAY "DESCRI:"
   @ 02,01 SAY "COSTO :"
   @ 03,01 SAY "PRECIO:"
   @ 04,01 SAY "UNIDAD:"
   @ 05,01 SAY "HNRO.?:"
   @ 06,01 SAY "AREA  :"
   @ 00,14 GET M.SERVICIO PICTURE "##-##-##-###"
   READ
   IF LASTKEY()=27
      EXIT
   ENDIF
   SEEK M.SERVICIO
   IF FOUND()
      @ 01,09 SAY DESCRI
      @ 02,09 SAY COSTO  PICTURE "99,999,999.99"
      @ 03,09 SAY PRECIOA PICTURE "99,999,999.99"
      @ 03,23 SAY PRECIOB PICTURE "99,999,999.99"
      @ 03,37 SAY PRECIOC PICTURE "99,999,999.99"
      @ 03,51 SAY PRECIOD PICTURE "99,999,999.99"
      @ 03,65 SAY PRECIOE PICTURE "99,999,999.99"
      @ 04,09 SAY UNIDAD
      @ 05,09 SAY HONORARIO
      @ 06,09 SAY PUNTO
      READ
      LOOP
   ELSE
      @ 01,09 GET M.DESCRI
      IF LEN(RTRIM(LTRIM(M.SERVICIO)))=LEN(SERVICIO)
         @ 02,09 GET M.COSTO   PICTURE "99,999,999.99"
         @ 03,09 GET M.PRECIOA PICTURE "99,999,999.99"
         @ 03,23 GET M.PRECIOB PICTURE "99,999,999.99"
         @ 03,37 GET M.PRECIOC PICTURE "99,999,999.99"
         @ 03,51 GET M.PRECIOD PICTURE "99,999,999.99"
         @ 03,65 GET M.PRECIOE PICTURE "99,999,999.99"
         @ 04,09 GET M.UNIDAD
         @ 05,09 GET M.HONORARIO
      ENDIF
      @ 06,09 GET M.PUNTO
      READ
      *** INICIO RUTINA DE ACEPTAR-CANCELAR
      store 1 to wop
      do while .t.
         @ 07,22  get wop pict "@*H Aceptar;Cancelar" defa wop
         read
         if lastkey()=13
            exit
         endif
      enddo
      *** FIN  RUTINA ACEPTAR-CANCELAR
      if wop=1
         if filloc()
            append blank
            gath memvar
            unlock all
         endif
      endif
   ENDIF
ENDDO
RELEASE WIND WINCSER
RETURN
***
PROCEDURE BRMOD
DEFI WIND WMODSER FROM LIBRSER+5,CIBRSER TO LIBRSER+14,CIBRSER+79;
                  TITLE " MODIFICAR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WMODSER
SCAT MEMVAR
@ 00,01 SAY "CODIGO:"
@ 01,01 SAY "DESCRI:"
@ 02,01 SAY "COSTO :"
@ 03,01 SAY "PRECIO:"
@ 04,01 SAY "UNIDAD:"
@ 05,01 SAY "HNRO.?:"
@ 06,01 SAY "AREA  :"
@ 00,09 GET M.SERVICIO
@ 01,09 GET M.DESCRI
IF LEN(RTRIM(LTRIM(M.SERVICIO)))=LEN(SERVICIO)
   @ 02,09 GET M.COSTO   PICTURE "99,999,999.99"
   @ 03,09 GET M.PRECIOA PICTURE "99,999,999.99"
   @ 03,23 GET M.PRECIOB PICTURE "99,999,999.99"
   @ 03,37 GET M.PRECIOC PICTURE "99,999,999.99"
   @ 03,51 GET M.PRECIOD PICTURE "99,999,999.99"
   @ 03,65 GET M.PRECIOE PICTURE "99,999,999.99"
   @ 04,09 GET M.UNIDAD
   @ 05,09 GET M.HONORARIO
ENDIF
@ 06,09 GET M.PUNTO
READ
*** INICIO RUTINA DE ACEPTAR-CANCELAR
store 1 to wop
do while .t.
   @ 07,22  get wop pict "@*H Aceptar;Cancelar" defa wop
   read
   if lastkey()=13
      exit
   endif
enddo
*** FIN  RUTINA ACEPTAR-CANCELAR
if wop=1
   if recloc()
      gath memvar
      unlock all
   endif
endif
RELEASE WIND WMODSER
RETURN
***
PROCEDURE BRELI
DEFI WIND WELISER FROM LIBRSER+5,CIBRSER TO LIBRSER+14,CIBRSER+79;
                  TITLE " ELIMINAR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WELISER
SCAT MEMVAR
@ 00,01 SAY "CODIGO:"
@ 01,01 SAY "DESCRI:"
@ 02,01 SAY "COSTO :"
@ 03,01 SAY "PRECIO:"
@ 04,01 SAY "UNIDAD:"
@ 05,01 SAY "HNRO.?:"
@ 06,01 SAY "AREA  :"
@ 00,09 SAY M.SERVICIO
@ 01,09 SAY M.DESCRI
@ 02,09 SAY M.COSTO  PICTURE "99,999,999.99"
@ 02,09 SAY COSTO    PICTURE "99,999,999.99"
@ 03,09 SAY PRECIOA  PICTURE "99,999,999.99"
@ 03,23 SAY PRECIOB  PICTURE "99,999,999.99"
@ 03,37 SAY PRECIOC  PICTURE "99,999,999.99"
@ 03,51 SAY PRECIOD  PICTURE "99,999,999.99"
@ 03,65 SAY PRECIOE  PICTURE "99,999,999.99"
@ 04,09 SAY UNIDAD
@ 05,09 SAY HONORARIO
*** INICIO RUTINA DE ACEPTAR-CANCELAR
store 2 to wop
do while .t.
   @ 07,22  get wop pict "@*H Aceptar;Cancelar" defa wop
   read
   if lastkey()=13
      exit
   endif
enddo
*** FIN  RUTINA ACEPTAR-CANCELAR
if wop=1
   if recloc()
      delete
      unlock all
   endif
endif
RELEASE WIND WELISER
RETURN
***
PROCEDURE BRBUS
DEFI WIND WBUSSER FROM LIBRSER+5,CIBRSER TO LIBRSER+10,CIBRSER+75;
                  TITLE " BUSCAR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WBUSSER
DO WHILE .T.
   SCAT MEMV BLANK
   @ 00,01 SAY "SERVICIO   :"
   @ 01,01 SAY "DESCRIPCION:"
   @ 00,14 GET M.SERVICIO PICTURE "##-##-##-###"
   READ
   IF LASTKEY()=27
      EXIT
   ENDIF
   STORE M.SERVICIO TO WCLAVESER
   IF LEN(TRIM(WCLAVESER))=0
      LOOP
   ENDIF
   SEEK WCLAVESER
   IF FOUND()
      EXIT
   ENDIF
ENDDO
RELEASE WIND WBUSSER
RETURN
***
PROCEDURE BRORD
* SET ORDER TO ??
RETURN

