PUSH KEY CLEAR
DEFI WIND WINDSO FROM 6,5 TO 20,75;
          TITLE  " SOLICITUDES POR EJECUTAR ";
          FOOTER " Esc=Seleccionar " ;
          DOUBLE NOFLOAT NOZOOM NOGROW COLOR SCHEME 10
ACTI WIND WINDSO
SELECT SERDCGE
GO BOTT
   BROWSE FIELDS NUMERO:H="NUMERO",ELABORADO:H="FECHA",;
                 WNOMPAC=FUNCNOM():H="PACIENTE                      ",;
                 MONTO:H="MONTO",ORDENADO:H="SOL",PROVEEDOR:H="EJE";
          NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW WINDSO;
          FOR SUBSTR(NUMERO,1,3)="SOL"         .AND.;
              (FACTURA<>SPACE(10).OR.MONTO=0)  .AND.;
              COMPROB=SPACE(10)
DEACT WIND WINDSO
POP KEY
RETURN
************
FUNC FUNCNOM
************
STORE SPACE(1) TO WNOMPAC
STORE SPACE(1) TO M.NOMPAC
STORE TIPPAC   TO M.TIPPAC
STORE CODPAC   TO M.CODPAC
DO BUSPAC
STORE M.NOMPAC TO WNOMPAC
SELECT SERDCGE
RETURN WNOMPAC
****************
PROCEDURE BUSPAC
****************
IF M.TIPPAC="A"
   SELECT AFIAFI
   SET ORDER TO AFIAFI1
   SEEK M.CODPAC
   IF .NOT. FOUND()
      STORE "" TO M.NOMPAC
   ELSE
      STORE ALLTRIM(PAPELLIDO)+", "+ALLTRIM(PNOMBRE) TO M.NOMPAC
      STORE .T. TO WFLAGPAC
   ENDIF
ELSE
   SELECT SYSPAC
   SEEK M.CODPAC
   IF .NOT. FOUND()
      STORE "" TO M.CODPAC    
   ELSE
      STORE ALLTRIM(PAPELLIDO)+", "+ALLTRIM(PNOMBRE) TO M.NOMPAC
      STORE .T. TO WFLAGPAC
   ENDIF
ENDIF
RETURN 
