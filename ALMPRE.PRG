STORE SPACE(3)  TO WLINEA
STORE SPACE(20) TO WCODIGO
STORE 0         TO WFACTOR
@ 10,54 CLEAR TO 18,77
@ 10,54       TO 18,77
@ 11,55  SAY " REPRECIACION  "
@ 12,55  SAY "LINEA DE VENTA:"
@ 13,55  SAY "CODIGO ARTICULO"
@ 15,55  SAY "Precio/Costo  :"
@ 16,55  SAY "FACTOR        :"
@ 12,71 GET WLINEA
READ
IF READKEY() = 12 .OR. READKEY() = 268
   RETURN
ENDIF
IF WLINEA = SPACE(3)
   @ 12,70 SAY "TODAS"
ELSE
   SELECT ALMLIN
   FIND &WLINEA
   IF EOF()
      STORE "LINEA DE VENTA NO REGISTRADA. <ENTER>" TO MES
      DO AVISO WITH MES
      RETURN
   ENDIF
ENDIF
@ 14,55 GET WCODIGO
READ
IF READKEY() = 12 .OR. READKEY() = 268
   RETURN
ENDIF
IF WCODIGO = SPACE(20)
   @ 14,55 SAY "TODOS"
ELSE
   SELECT ALMART
   FIND &WCODIGO
   IF EOF()
      STORE "ARTICULO NO REGISTRADO. <ENTER>" TO MES
      DO AVISO WITH MES
      RETURN
   ENDIF
ENDIF
STORE .T. TO VERCOS
DO WHILE VERCOS
   STORE SPACE(1) TO WPRECOS
   @ 15,70 GET WPRECOS
   READ
   STORE UPPER(WPRECOS) TO WPRECOS
   IF WPRECOS = "P" .OR. WPRECOS = "C"
      STORE .F. TO VERCOS
      LOOP
   ENDIF
ENDDO
@ 16,70 GET WFACTOR PICTURE "##.##" RANGE 0.1, 99.99
READ
IF WFACTOR = 0 .OR. READKEY() = 12 .OR. READKEY() = 268
   RETURN
ENDIF
STORE "CONFORME ? (S/N)" TO TEX
STORE "NS" TO WCH
DO PREGUNTA
IF WCH = "N"
   RETURN
ENDIF
STORE "REPRECIANDO ARTICULOS SELECCIONADOS. FAVOR ESPERAR..." TO MES
DO MENSAJE WITH MES

SELECT ALMART
GO TOP
DO WHILE .NOT. EOF()
   IF WLINEA <> SPACE(3) .AND. WLINEA <> LINEA
      SKIP
      LOOP
   ENDIF
   IF WCODIGO<> SPACE(20) .AND. WCODIGO <> CODIGO
      SKIP
      LOOP
   ENDIF
   IF WPRECOS = "C"
      IF ULTCANTI>0
         REPLACE PRECIO  WITH (ULTCOSTO/ULTCANTI)*WFACTOR
      ENDIF
   ELSE
      REPLACE PRECIO  WITH PRECIO*WFACTOR
   ENDIF
   SELECT ALMART
   SKIP
ENDDO
RETURN



