SELECT AFIORGA
DEFI WIND BRORG FROM LIBRORG,CIBRORG TO LIBRORG+10,CIBRORG+70 ;
                TITLE " ORGANIZACIONES AFILIADAS " ;
                FOOTER " F1=Inc, F2=Mod, F3=Eli, F4=Bus, ESC=Sel ";
                DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND BRORG
ON KEY LABEL F1 DO BRINC
ON KEY LABEL F2 DO BRMOD
ON KEY LABEL F3 DO BRELI
ON KEY LABEL F4 DO BRBUS
BROWSE FIELDS ORGA:H="ORGANIZACION", NIVORG1:H="NIVEL 1", NIVORG2:H="NIVEL 2", NIVORG3:H="NIVEL 3", DESCRI:H="DESCRIPCION";
              NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW BRORG
ON KEY LABEL F1
ON KEY LABEL F2
ON KEY LABEL F3
ON KEY LABEL F4
RELEASE WIND BRORG
RETURN
***********************
***                 ***
***RUTINAS DE BRORG ***
***                 ***
***********************
PROCEDURE BRINC
STORE .T. TO WINC
DEFI WIND WINC FROM LIBRORG+5,CIBRORG+10 TO LIBRORG+12,CIBRORG+75;
               TITLE " INCLUIR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINC
DO WHILE WINC
   SCAT MEMV BLANK
   @ 00,00 CLEAR
   @ 00,01 SAY "ORGANIZACION        :"
   @ 01,01 SAY "NIVEL ORGANIZATIVO 1:"
   @ 02,01 SAY "NIVEL ORGANIZATIVO 2:"
   @ 03,01 SAY "NIVEL ORGANIZATIVO 3:"
   @ 04,01 SAY "DESCRIPCION         :"
   @ 00,23 GET M.ORGA
   @ 01,23 GET M.NIVORG1
   @ 02,23 GET M.NIVORG2
   @ 03,23 GET M.NIVORG3
   READ
   IF LASTKEY()=27
      RELEASE WIND WINC
      EXIT
   ENDIF
   STORE M.ORGA+M.NIVORG1+M.NIVORG2+M.NIVORG3 TO WCLAVEORG
   IF LEN(TRIM(WCLAVEORG))=0
      LOOP
   ENDIF
   SEEK WCLAVEORG
   IF FOUND()
      @ 04,23 SAY DESCRI
      STORE "ORGANIZACION YA REGISTRADA, VERIFIQUE" TO WTEXT
      DO AVISO WITH WTEXT
      LOOP
   ELSE
      @ 04,23 GET M.DESCRI
      READ
      *** INICIO RUTINA DE ACEPTAR-CANCELAR
      store 1 to wop
      do while .t.
         @ 05,22  get wop pict "@*H Aceptar;Cancelar" defa wop
         read
         if lastkey()=13
            exit
         endif
      enddo
      *** FIN  RUTINA ACEPTAR-CANCELAR
      if wop=1
         if filloc()
            append blank
            gath memvar
            unlock all
         endif
      endif
   ENDIF
ENDDO
RETURN
***
PROCEDURE BRMOD
IF EOF()
   RETURN
ENDIF
DEFI WIND WMOD FROM LIBRORG+5,CIBRORG+10 TO LIBRORG+12,CIBRORG+75;
               TITLE " MODIFICAR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WMOD
SCAT MEMVAR
@ 00,01 SAY "ORGANIZACION        :"
@ 01,01 SAY "NIVEL ORGANIZATIVO 1:"
@ 02,01 SAY "NIVEL ORGANIZATIVO 2:"
@ 03,01 SAY "NIVEL ORGANIZATIVO 3:"
@ 04,01 SAY "DESCRIPCION         :"
@ 00,23 SAY M.ORGA
@ 01,23 SAY M.NIVORG1
@ 02,23 SAY M.NIVORG2
@ 03,23 SAY M.NIVORG3
@ 04,23 GET M.DESCRI
READ
*** INICIO RUTINA DE ACEPTAR-CANCELAR
store 1 to wop
do while .t.
   @ 05,22  get wop pict "@*H Aceptar;Cancelar" defa wop
   read
   if lastkey()=13
      exit
   endif
enddo
*** FIN  RUTINA ACEPTAR-CANCELAR
if wop=1
   if recloc()
      gath memvar
      unlock all
   endif
endif
RELEASE WIND WMOD
RETURN
***
PROCEDURE BRELI
DEFI WIND WELI FROM LIBRORG+5,CIBRORG+10 TO LIBRORG+12,CIBRORG+75;
               TITLE " ELIMINAR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WELI
SCAT MEMVAR
@ 00,01 SAY "ORGANIZACION        :"
@ 01,01 SAY "NIVEL ORGANIZATIVO 1:"
@ 02,01 SAY "NIVEL ORGANIZATIVO 2:"
@ 03,01 SAY "NIVEL ORGANIZATIVO 3:"
@ 04,01 SAY "DESCRIPCION         :"
@ 00,23 SAY M.ORGA
@ 01,23 SAY M.NIVORG1
@ 02,23 SAY M.NIVORG2
@ 03,23 SAY M.NIVORG3
@ 04,23 SAY M.DESCRI
*** INICIO RUTINA DE ACEPTAR-CANCELAR
store 1 to wop
do while .t.
   @ 05,22  get wop pict "@*H Aceptar;Cancelar" defa wop
   read
   if lastkey()=13
      exit
   endif
enddo
*** FIN  RUTINA ACEPTAR-CANCELAR
if wop=1
   if recloc()
      delete
      unlock all
   endif
endif
RELEASE WIND WELI
RETURN
***
PROCEDURE BRBUS
STORE .T. TO WBUS
DEFI WIND WBUS FROM LIBRORG+5,CIBRORG+10 TO LIBRORG+12,CIBRORG+75;
               TITLE " BUSCAR " DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WBUS
DO WHILE WBUS
   SCAT MEMV BLANK
   @ 00,01 SAY "ORGANIZACION        :"
   @ 01,01 SAY "NIVEL ORGANIZATIVO 1:"
   @ 02,01 SAY "NIVEL ORGANIZATIVO 2:"
   @ 03,01 SAY "NIVEL ORGANIZATIVO 3:"
   @ 04,01 SAY "DESCRIPCION         :"
   @ 00,23 GET M.ORGA
   @ 01,23 GET M.NIVORG1
   @ 02,23 GET M.NIVORG2
   @ 03,23 GET M.NIVORG3
   READ
   IF LASTKEY()=27
      RELEASE WIND WBUS
      EXIT
   ENDIF
   STORE M.ORGA+M.NIVORG1+M.NIVORG2+M.NIVORG3 TO WCLAVEORG
   IF LEN(TRIM(WCLAVEORG))=0
      LOOP
   ENDIF
   SEEK WCLAVEORG
   IF FOUND()
      EXIT
   ELSE
      STORE "NO REGISTRADO, VERIFIQUE" TO WTEXT
      DO AVISO WITH WTEXT
   ENDIF
ENDDO
RELEASE WIND WBUS
RETURN
***
PROCEDURE BRORD
* SET ORDER TO ??
RETURN

