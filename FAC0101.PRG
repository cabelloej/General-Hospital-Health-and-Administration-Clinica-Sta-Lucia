DEFI WIND WINDGRU FROM 05,0 TO 20,60;
          TITLE " GRUPOS " ;
          FOOTER " F1=Inc, F2=Mod, F3=Eli, F4=Bus, Esc=Salir " ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDGRU
PUSH KEY CLEAR
ON KEY LABEL F1 DO PROGRUI
ON KEY LABEL F2 DO PROGRUM
ON KEY LABEL F3 DO PROGRUE
ON KEY LABEL F5 DO PROGRUB
SELECT FACGRU
BROWSE FIELDS CODGRU:H="CODIGO",DESGRU:H="NOMBRE";
       NOAPPEND NODELETE NOEDIT NOMENU NOOPTIMIZE REST SAVE IN WINDOW WINDGRU
DEACT WIND WINDGRU
POP KEY
RETURN
************
PROC PROGRUI
************
PUSH KEY CLEAR
STORE "INCLUIR" TO WFLAGR
SELECT FACGRU
SCATT MEMV BLANK
DO GETGRU
POP KEY
RETURN
************
PROC PROGRUM
************
PUSH KEY CLEAR
STORE "MODIFICAR" TO WFLAGR
SELECT FACGRU
SCATT MEMV
DO GETGRU
POP KEY
RETURN
************
PROC PROGRUE
************
PUSH KEY CLEAR
STORE "ELIMINAR" TO WFLAGR
STORE 2 TO WOP
DO PROCOPC WITH WFLAGR
IF WOP=1
   SELECT FACGRU
   IF RECLOC()
      DELETE
      UNLOCK
   ELSE
      DO PROCNUL
   ENDIF
ENDIF
POP KEY
RETURN
************
PROC PROGRUB
************
PUSH KEY CLEAR
POP KEY
RETURN
******
***********
PROC GETGRU
***********
PUSH KEY CLEAR
DEFI WIND WINDGETC FROM 06,5 TO 10,79;
          TITLE  WFLAGR ;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTI WIND WINDGETC
IF WFLAGR="INCLUIR"
   @ 0,1 SAY "Codigo     :" GET M.CODGRU
   READ
   SELECT FACGRU
   SEEK M.CODGRU
   IF FOUND()
      STORE "CODIGO YA EXISTE :"+ALLTRIM(DESGRU) TO WTEXT
      DO AVISO WITH WTEXT
      RELE WIND WINDGETC
      RETURN
   ENDIF
ELSE
   @ 0,1 SAY "Codigo     :" +   M.CODGRU
ENDIF
@ 2,1 SAY "Nombre     :" GET M.DESGRU
READ
STORE 1 TO WOP
DO PROCOPC WITH WFLAGR
IF WOP=1
   SELECT FACGRU
   IF WFLAGR="INCLUIR"
      IF FILLOC()
         APPEND BLANK
         GATH MEMV
         UNLOCK ALL
      ELSE
        DO PROCNUL
      ENDIF
   ELSE
      IF RECLOC()
         GATH MEMV
         UNLOCK ALL
      ELSE
        DO PROCNUL
      ENDIF
   ENDIF
ENDIF
RELE WIND WINDGETC
POP KEY
RETURN
************
PROC PROCOPC
************
PARA WTITLE
DEFI WIND WINDCON FROM 12,19 TO 14,59;
          TITLE WTITLE;
          DOUBLE NOFLOAT NOZOOM NOGROW SHADOW COLOR SCHEME 10
ACTIVATE WIND WINDCON
DO WHILE .T.
   @ 00,03 SAY "OPCIONES: ";
   GET WOP PICT "@*H ACEPTAR  ;CANCELAR "
   READ
   IF LASTKEY()=13
      EXIT
   ENDIF
ENDDO
RELE WIND WINDCON
RETURN
************
PROC PROCNUL
************
STORE "OPERACION RECHAZADA, FAVOR REINTENTAR." TO WTEXT
DO AVISO WITH WTEXT
RETURN
************
